<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>settings</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >pySTEP_1.20</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Module&nbsp;settings
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="settings-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module settings</h1><p class="nomargin-top"><span class="codelink"><a href="settings-pysrc.html">source&nbsp;code</a></span></p>
<h1 class="heading">settings</h1>
    <p>Contains all parameters for the evolutionary run, grammar rules, 
    constraints, and specifics about the terminal and function set of the 
    trees.</p>
    <p>First we have to create a Terminal set and a Function set for the 
    tree. A Node object is a tuple composed of three elements e.g. 
    (0,2,'root')</p>
    <ul>
      <li>
        The first element represent the type of node:
        <ul>
          <li>
            0 Root Branch
          </li>
          <li>
            1 Function Branch
          </li>
          <li>
            2 ADF Defining Branch
          </li>
          <li>
            3 Variable Leaf
          </li>
          <li>
            4 Constant Leaf
          </li>
          <li>
            5 ADF Leaf
          </li>
        </ul>
      </li>
      <li>
        The second element is the arity of the Node (number of children). 
        If the number of children &gt;0 then it is a branch node, if arity 
        = 0 then it is a leaf node... e.g. (0,2,'root') means the root node
        has two children.
      </li>
      <li>
        The third element is the name or unique identifier of the Node. e.g
        (1,2,'+') is a function branch node with two children and unique 
        identifier '+' while (1,2,'*') is a function branch node with two 
        children and unique identifier '*'
      </li>
    </ul>
    <p>Then we define the terminal nodes, and map them with corresponding 
    methods. e.g.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   terminals = {
<span class="py-output">'x':all_x,</span>
<span class="py-output">'y':all_y,</span>
<span class="py-output">'1-10':random.random()*10</span>
<span class="py-output">}</span></pre>
    <p>Then we have to map values to the leaf nodes. We define the number 
    of examples we learn from</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   nb_ex=100</pre>
    <p>We define all variable x in a list of corresponding size, and same 
    for y. e.g.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   all_x=[]
<span class="py-output">all_y=[]</span>
<span class="py-output">for i in xrange(nb_ex):</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>   all_x.append(random.random()*10)
<span class="py-prompt">&gt;&gt;&gt; </span>   all_y.append(random.random()*10)</pre>
    <p>Then we have to define and map functions to the branch nodes to 
    perform operations such as for example: arithmetic addition, 
    subtraction, multiplication... Whatever operation is needed in the 
    function set of a tree should be created here. e.g.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   functions = {<span class="py-string">'+'</span>:add,
<span class="py-output">'*':multiply,</span>
<span class="py-output">'adf2_+':add,</span>
<span class="py-output">'adf2_*':multiply,</span>
<span class="py-output">'adf1':adfBranch,</span>
<span class="py-output">'adf2':adfBranch,</span>
<span class="py-output">'root':rootBranch</span>
<span class="py-output">}</span></pre>
    <p>Where functions like add are defined like this:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   <span class="py-keyword">def</span> <span class="py-defname">add</span>(listElem):
<span class="py-output">try:</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>   return listElem[0]+listElem[1]
<span class="py-output">except:</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>   raise WrongValues, &quot;Wrong <span class="py-builtin">values</span> sent to function node.
<span class="py-output">Can't get result&quot;</span>
<span class="py-output">exit</span></pre>
    <p>We finally need to define some kind of rules or constraints that 
    will dictate the shapes of the generated trees.</p>
    <p>We define how strongly typed we want the evolution to be.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   Strongly_Typed_Crossover_degree=1</pre>
    <p>It means the trees generated have to be compliant with the 
    constraints, and that the crossover and mutation operations will spend 
    some computational time trying to make sure offspring are compliant. We
    also specify what happens after the system has tried 100 times to 
    produced rules-compliant offsprings using crossover but has failed. 
    Either we accept the unfit offsprings with Substitute_Mutation=0 or we 
    substitute them with a mutated tree by setting Substitute_Mutation=1. 
    In our case, the rules are very simple, so we can set :</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   Substitute_Mutation=0</pre>
    <p>Next, we need to specify a fitness function. e.g.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   <span class="py-keyword">def</span> <span class="py-defname">FitnessFunction</span>(my_tree):
<span class="py-prompt">&gt;&gt;&gt; </span>       return evalfitness.FinalFitness(evalfitness.EvalTreeForAllInputSets(my_tree,xrange(nb_eval)))</pre>
    <p>This fitness function reuses two functions : 
    EvalTreeForAllInputSets: parse the tree by plugging input values and 
    computing the result obtained at the top of the tree. FinalFitness: 
    returns the overall fitness of a tree over a set of datapoints using 
    the result of the previous function as an input. It contains problem 
    specific aspects of the fitness calculation.</p>
    <p>Then we set the rules treeRules for producing a tree. e.g.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   <span class="py-comment"># the crossover mapping spec is empty in this case</span>
<span class="py-output">crossover_mapping=[]</span>
<span class="py-output"># default function set applicable by for branches:</span>
<span class="py-output">defaultFunctionSet= [(1,2,'+'),(1,2,'*'),(1,2,'-'),(1,1,'neg'),(1,1,'^2')]</span>
<span class="py-output"># default terminal set applicable by for branches:</span>
<span class="py-output">defaultTerminalSet= [(3,0,'x'),(3,0,'y')]</span>
<span class="py-output">defaultTerminalSet.extend(set_ERC)</span>
<span class="py-output">treeRules = {'root':[(defaultFunctionSet,defaultTerminalSet)],</span>
<span class="py-output"></span><span class="py-prompt">&gt;&gt;&gt; </span>     <span class="py-string">'+'</span>:[(defaultFunctionSet,defaultTerminalSet),(defaultFunctionSet,defaultTerminalSet)],
<span class="py-prompt">&gt;&gt;&gt; </span>     <span class="py-string">'*'</span>:[(defaultFunctionSet,defaultTerminalSet),(defaultFunctionSet,defaultTerminalSet)],
<span class="py-prompt">&gt;&gt;&gt; </span>     <span class="py-string">'^2'</span>:[(defaultFunctionSet,defaultTerminalSet)],
<span class="py-prompt">&gt;&gt;&gt; </span>     <span class="py-string">'-'</span>:[(defaultFunctionSet,defaultTerminalSet),(defaultFunctionSet,defaultTerminalSet)],
<span class="py-prompt">&gt;&gt;&gt; </span>     <span class="py-string">'neg'</span>:[([(1,2,<span class="py-string">'+'</span>),(1,2,<span class="py-string">'*'</span>),(1,2,<span class="py-string">'-'</span>),(1,1,<span class="py-string">'^2'</span>)],defaultTerminalSet)]
<span class="py-prompt">&gt;&gt;&gt; </span>     }</pre>
    <p>We also define what function branches can be changed during 
    crossover, to make an a fragment compliant with a new parent tree. 
    e.g.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   crossover_mapping=[(<span class="py-string">'+'</span>,<span class="py-string">'adf2_+'</span>),(<span class="py-string">'adf2_+'</span>,<span class="py-string">'+'</span>),(<span class="py-string">'*'</span>,<span class="py-string">'adf2_*'</span>),(<span class="py-string">'adf2_*'</span>,<span class="py-string">'*'</span>)]</pre>
    <p>We finally precise that order matters in the appearance of the ADF 
    defining branches</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>   adfOrdered = True</pre>
    <p>means that the ADF1 defining branch will appear before the ADF2 
    defining branch. This is especially useful if you need to define a 
    model a forest of ordered sub trees...</p>
    <p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY 
    KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND 
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE 
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION 
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION 
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>

<hr />
<div class="fields">      <p><strong>Author:</strong>
        by Mehdi Khoury
      </p>
      <p><strong>Version:</strong>
        1.00
      </p>
      <p><strong>Copyright:</strong>
        (c) 2009 Mehdi Khoury under the mit license 
        http://www.opensource.org/licenses/mit-license.html
      </p>
      <p><strong>Contact:</strong>
        mehdi.khoury at gmail.com
      </p>
</div><!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="settings-module.html#functions" class="summary-name">functions</a> = <code title="{'+': add, '-': sub, 'neg': neg, '*': multiply, '^2': square, 'cos': c\
os, 'sin': sin, 'root': rootBranch}">{'+': add, '-': sub, 'neg': neg, '*': multiply, '^<code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="terminals"></a><span class="summary-name">terminals</span> = <code title="{'x': [8.53448321749, 9.59457914387]}"><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">x</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">[</code>8.53448321749<code class="variable-op">, </code>9.59457914387<code class="variable-group">]</code><code class="variable-group">}</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="crossover_mapping"></a><span class="summary-name">crossover_mapping</span> = <code title="[]"><code class="variable-group">[</code><code class="variable-group">]</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="nb_eval"></a><span class="summary-name">nb_eval</span> = <code title="2">2</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="ideal_results"></a><span class="summary-name">ideal_results</span> = <code title="[[693.837821075], [974.308418411]]"><code class="variable-group">[</code><code class="variable-group">[</code>693.837821075<code class="variable-group">]</code><code class="variable-op">, </code><code class="variable-group">[</code>974.308418411<code class="variable-group">]</code><code class="variable-group">]</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="Strongly_Typed_Crossover_degree"></a><span class="summary-name">Strongly_Typed_Crossover_degree</span> = <code title="0">0</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="Substitute_Mutation"></a><span class="summary-name">Substitute_Mutation</span> = <code title="0">0</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="settings-module.html#treeRules" class="summary-name">treeRules</a> = <code title="{'*': [([(1, 2, '+'),
         (1, 2, '*'),
         (1, 1, '^2'),
         (1, 2, '-'),
         (1, 1, 'cos'),
         (1, 1, 'sin'),
         (1, 1, 'neg')],
        [(3, 0, 'x')]),
..."><code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">*</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">[</code><code class="variable-group">(</code><code class="variable-group">[</code><code class="variable-group">(</code>1<code class="variable-op">, </code>2<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">+</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code>1<code class="variable-op">, </code>2<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">*</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code>1<code class="variable-op">, </code>1<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">^2</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">, </code><code class="variable-group">(</code><code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="adfOrdered"></a><span class="summary-name">adfOrdered</span> = <code title="False">False</code>
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="None">None</code>
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-VariablesDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="functions"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">functions</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
{'+': add, '-': sub, 'neg': neg, '*': multiply, '^2': square, 'cos': c<span class="variable-linewrap"><img src="crarr.png" alt="\" /></span>
os, 'sin': sin, 'root': rootBranch}
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<a name="treeRules"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">treeRules</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
<code class="variable-group">{</code><code class="variable-quote">'</code><code class="variable-string">*</code><code class="variable-quote">'</code><code class="variable-op">: </code><code class="variable-group">[</code><code class="variable-group">(</code><code class="variable-group">[</code><code class="variable-group">(</code>1<code class="variable-op">, </code>2<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">+</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">,</code>
         <code class="variable-group">(</code>1<code class="variable-op">, </code>2<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">*</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">,</code>
         <code class="variable-group">(</code>1<code class="variable-op">, </code>1<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">^2</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">,</code>
         <code class="variable-group">(</code>1<code class="variable-op">, </code>2<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">-</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">,</code>
         <code class="variable-group">(</code>1<code class="variable-op">, </code>1<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">cos</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">,</code>
         <code class="variable-group">(</code>1<code class="variable-op">, </code>1<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">sin</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-op">,</code>
         <code class="variable-group">(</code>1<code class="variable-op">, </code>1<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">neg</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-group">]</code><code class="variable-op">,</code>
        <code class="variable-group">[</code><code class="variable-group">(</code>3<code class="variable-op">, </code>0<code class="variable-op">, </code><code class="variable-quote">'</code><code class="variable-string">x</code><code class="variable-quote">'</code><code class="variable-group">)</code><code class="variable-group">]</code><code class="variable-group">)</code><code class="variable-op">,</code>
<code class="variable-ellipsis">...</code>
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >pySTEP_1.20</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Apr 15 11:36:18 2009
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
